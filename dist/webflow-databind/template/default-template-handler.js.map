{
  "version": 3,
  "sources": ["../../../src/globals.ts", "../../../src/webflow-core/debug.ts", "../../../src/webflow-core/designer.ts", "../../../src/webflow-core.ts", "../../../src/webflow-crypto.ts", "../../../src/webflow-membership.ts", "../../../src/webflow-databind.ts", "../../../src/webflow-databind/template/default-template-handler.ts"],
  "sourcesContent": ["\n/**\n * SA5 Globals\n * \n */\n\nexport enum Sa5GlobalVar {\n\n    GLOBAL_ROUTE = 'sa5-route' \n\n}\n\nexport enum Sa5GlobalEvent {\n\n    EVENT_USER_CHANGED = 'userInfoChanged',\n    EVENT_DATASTORE_LOADED = 'datastoreLoaded',\n    EVENT_SLIDE_CHANGED = 'slideChanged', \n    EVENT_SLIDE_NEXT_REQUEST = 'slideNextRequest', \n    EVENT_SLIDE_PREV_REQUEST = 'slidePrevRequest', \n    EVENT_TAB_CHANGED = 'tabChanged', \n    EVENT_ACCORDION_CHANGED = 'accordionChanged', \n    EVENT_VIDEO_PLAYER_STATE_CHANGE = 'playerStateChange', \n    \n}\n\nexport enum Sa5ScriptType {\n\n    SCRIPT_TYPE_DATA_ITEM = 'wfu-data-item', \n    SCRIPT_TYPE_SA5_DATA_ITEM = 'sygnal/sa5-data', // 'sygnal/sa5-data-proto', \n\n}\n\nexport namespace Sa5Attribute {\n    export function getBracketed(attr: Sa5Attribute): string {\n        return `[${attr}]`;\n    }\n}\n\nexport enum Sa5Attribute {\n\n    // Core\n    ATTR_CORE_SCRIPT_INJECT = 'wfu-script-load', \n\n    // Video\n    ATTR_VIDEO = 'wfu-video',\n    ATTR_VIDEO_YOUTUBE_NOREL = 'wfu-youtube-norel', \n    ATTR_VIDEO_DATA_POSTER_URL = 'wfu-data-poster-url', \n\n    // Designer\n    ATTR_DESIGN = 'wfu-design',\n\n    // Elements \n    ATTR_ELEMENT_SLIDER = 'wfu-slider',\n        ATTR_ELEMENT_SLIDE_NAME = 'wfu-slide-name',\n    ATTR_ELEMENT_TABS = 'wfu-tabs',\n        ATTR_ELEMENT_TAB_NAME = 'wfu-tab-name',\n    ATTR_ELEMENT_BUTTON = 'wfu-button', \n        ATTR_BUTTON_ENABLED = 'wfu-button-enabled', \n        ATTR_BUTTON_DISABLED_CLASS = 'wfu-button-disabled-class',\n    ATTR_ELEMENT_DECK_TARGET = 'wfu-deck-target',\n        ATTR_ELEMENT_DECK_ACTION = 'wfu-deck-action',\n        ATTR_ELEMENT_DECK_ITEM = 'wfu-deck-action-item',\n    ATTR_ELEMENT_DROPDOWN = 'wfu-dropdown',\n        ATTR_ELEMENT_DROPDOWN_NAME = 'wfu-dropdown-name',\n        ATTR_ELEMENT_DROPDOWN_INIT = 'wfu-dropdown-init',\n        ATTR_ELEMENT_DROPDOWN_TYPE = 'wfu-dropdown-type',\n    ATTR_ELEMENT_AUTOCOMPLETE = 'wfu-autocomplete',\n        ATTR_ELEMENT_AUTOCOMPLETE_INPUT = 'wfu-autocomplete-input',\n        ATTR_ELEMENT_AUTOCOMPLETE_LIST = 'wfu-autocomplete-list',\n        ATTR_ELEMENT_AUTOCOMPLETE_ITEM = 'wfu-autocomplete-item',\n        ATTR_ELEMENT_AUTOCOMPLETE_ITEM_ACTION = 'wfu-autocomplete-item-action',\n        ATTR_ELEMENT_AUTOCOMPLETE_ITEM_MATCH = 'wfu-autocomplete-item-match',\n        ATTR_ELEMENT_AUTOCOMPLETE_ITEM_LAYOUT = 'wfu-autocomplete-item-layout',\n    ATTR_ELEMENT_ACCORDION = 'wfu-accordion',\n        ATTR_ELEMENT_ACCORDION_ITEM = 'wfu-accordion-item',\n        ATTR_ELEMENT_ACCORDION_ITEM_TAB = 'wfu-accordion-item-tab',\n        ATTR_ELEMENT_ACCORDION_ITEM_CONTENT = 'wfu-accordion-item-content',\n        ATTR_ELEMENT_ACCORDION_CLASS_OPEN = 'wfu-accordion-class-open',\n        ATTR_ELEMENT_ACCORDION_CLASS_CLOSED = 'wfu-accordion-class-closed',\n    \n\n\n    // Data\n    ATTR_DATA = 'wfu-data',\n    ATTR_DATA_TYPE = 'wfu-data-type',\n    ATTR_DATA_DSN = 'wfu-data-dsn',\n    ATTR_DATA_ITEM_ID = 'wfu-data-item-id',\n    \n    // Data-binding\n    ATTR_DATABIND = 'wfu-bind',\n    ATTR_DATABIND_CONTENT = 'wfu-bind-content',\n    ATTR_DATABIND_CONTEXT_DSN = 'wfu-bind-dsn',\n    ATTR_DATABIND_CONTEXT_ITEM_ID = 'wfu-bind-item-id',\n\n    // Pre-loaders\n    ATTR_PRELOAD = 'wfu-preload', \n\n    // Interactions\n    ATTR_IX_TRIGGER = 'wfu-ix-trigger',\n    ATTR_IX_ID = 'wfu-ix-id',\n\n    // Sort\n    ATTR_SORT = 'wfu-sort',\n    ATTR_SORT_DIR = 'wfu-sort-dir',\n    ATTR_SORT_TYPE = 'wfu-sort-type', \n    ATTR_SORT_KEY = 'wfu-sort-key', \n\n    // Filter\n    ATTR_FILTER = 'wfu-filter', // Deprecated\n    ATTR_FILTER_MATCH = 'wfu-filter-match',\n    ATTR_FILTER_EVAL = 'wfu-filter-eval',\n    ATTR_FILTER_FUNC = 'wfu-filter-func',\n\n    // Hiding & Suppression\n    ATTR_HIDE = 'wfu-hide',\n    ATTR_SUPPRESS = 'wfu-suppress',\n\n    // Encoded Emails\n    ATTR_EMAIL_ENCODED = 'wfu-email-encoded', \n\n    // 404\n    ATTR_404_SEARCH = 'wfu-404-search',\n\n    // Forms\n    ATTR_FORM_HANDLER = 'wfu-form-handler',\n    ATTR_FORM_MESSAGE = 'wfu-form-message',\n    ATTR_FORM_IPINFO = 'wfu-form-ipinfo',\n    \n    ATTR_FORM_SELECT = 'wfu-form-select',\n    ATTR_FORM_SELECT_MODE = 'wfu-form-select-mode',\n    ATTR_FORM_SELECT_THEME = 'wfu-form-select-theme',\n\n    // Dismiss\n    ATTR_DISMISS = 'wfu-dismiss', \n    ATTR_DISMISS_TRIGGER = 'wfu-dismiss-trigger',\n    ATTR_DISMISS_CLOSE = 'wfu-dismiss-close',\n    ATTR_DISMISS_CLOSE_TYPE = 'wfu-dismiss-close-type',\n    ATTR_DISMISS_DAYS = 'wfu-dismiss-suppress-days',\n\n    // Modals\n    ATTR_MODAL = 'wfu-modal', \n    ATTR_MODAL_TRIGGER_CLICK = 'wfu-modal-trigger-click',\n    ATTR_MODAL_STATE = 'wfu-modal-state', // INTERNAL - hidden \n    // ATTR_MODAL_TRIGGER = 'wfu-modal-trigger',\n    // ATTR_MODAL_CLOSE = 'wfu-modal-close',\n    // ATTR_MODAL_CLOSE_TYPE = 'wfu-modal-close-type',\n    // ATTR_MODAL_SUPPRESS_DAYS = 'wfu-modal-suppress-days',\n\n    // Format\n    ATTR_FORMAT = 'wfu-format',\n    ATTR_FORMAT_DATE = 'wfu-format-date',\n    ATTR_FORMAT_HANDLER = 'wfu-format-handler', \n    ATTR_FORMAT_MODE = 'wfu-format-mode',\n    ATTR_FORMAT_LOCALE = 'wfu-format-locale', \n    ATTR_FORMAT_SUFFIX = 'wfu-format-suffix',\n\n    // Countup\n    ATTR_COUNTUP = 'wfu-countup', \n    ATTR_COUNTUP_TRIGGER = 'wfu-countup-trigger',\n\n    // Demo\n    ATTR_DEMO_LINK = 'wfu-demo-link',\n\n    // Lightboxes\n    ATTR_LIGHTBOX_CAPTIONS = 'wfu-lightbox-captions',\n    ATTR_LIGHTBOX_GROUP = 'wfu-lightbox-group',\n\n    /**\n     * SA5 HTML\n     */\n\n    // Decode\n    ATTR_DECODE = 'wfu-decode',\n\n    // Limits\n    ATTR_LIMIT_MULTIPLE = 'wfu-limit-multiple',\n    ATTR_LIMIT_MULTIPLE_MIN = 'wfu-limit-multiple-min',\n\n    /**\n     * SA5 User Accounts\n     */\n\n    ATTR_SHOW_LOGGED_IN = 'wfu-show-logged-in',\n    ATTR_HIDE_LOGGED_IN = 'wfu-hide-logged-in',\n    ATTR_LOGIN_BUTTON = 'wfu-login-button',\n\n    /**\n     * SA5 Richtext\n     */\n\n    ATTR_RICHTEXT_LISTS = 'wfu-lists',\n    ATTR_RICHTEXT_LIST_THEME = 'wfu-list-theme',\n\n    /**\n     * SA5 URL\n     */\n\n    ATTR_URL_RELATIVE_LINKS = 'wfu-relative-links',\n    ATTR_URL_EXTERNAL_LINKS = 'wfu-external-links',\n\n    /**\n     * SA5 UI\n     */\n\n    // Accordion\n    ATTR_UI_ACCORDION = 'wfu-ui-accordion',\n\n    // Rating\n    ATTR_RATING = 'wfu-rating', \n\n    // Github GIST\n    ATTR_GIST = 'wfu-gist',\n    ATTR_GIST_COPY = 'wfu-gist-copy',\n\n    /**\n     * SA5 Layout \n     */\n\n    ATTR_LAYOUT = 'wfu-layout', \n    ATTR_LAYOUT_HANDLER = 'wfu-layout-handler',\n    ATTR_LAYOUT_TARGET = 'wfu-layout-target',\n    ATTR_LAYOUT_NS = 'wfu-layout-ns',\n    ATTR_LAYOUT_INIT = 'wfu-layout-init',\n\n    ATTR_ELEMENTGROUP_NAME = 'wfu-element-name',\n    ATTR_ELEMENTGROUP_GROUP = 'wfu-element-display',\n    ATTR_ELEMENTGROUP_DEFAULT = 'wfu-element-default',\n    ATTR_ELEMENTGROUP_DISPLAY = 'wfu-element-display',\n    ATTR_ELEMENTGROUP_TARGETGROUP = 'wfu-element-target-group',\n    ATTR_ELEMENTGROUP_TARGETNAME = 'wfu-element-target-name',\n    ATTR_ELEMENTGROUP_ACTION = 'wfu-element-action',\n\n}", "\n/*\n * webflow-core\n * \n * Sygnal Technology Group\n * http://sygnal.com\n * \n * Debug Utilities\n */\n\nimport { VERSION } from \"../version\";\n\n\n\nexport class Sa5Debug {\n    \n    private localStorageDebugFlag: string = 'sa5-debug';\n\n    private _enabled: boolean = false;\n    private _label: string;\n\n    // Get or set WFU persistent debug state\n    // which is stored in localStorage. \n    get persistentDebug(): boolean {\n        return Boolean(localStorage.getItem(this.localStorageDebugFlag)); \n    }\n    set persistentDebug(active: boolean) {\n        if (active) {\n            localStorage.setItem(this.localStorageDebugFlag, \"true\");\n            console.debug (`sa5-core debug enabled (persistent).`);\n        } else {\n            localStorage.removeItem(this.localStorageDebugFlag); \n            console.debug (`sa5-core debug disabled (persistent).`);\n        }\n    }\n\n    // Enable/disable debugging \n    get enabled(): boolean {\n\n        // localStorage is checked for a debug flag, to enable remote debug enabling \n        // Any non-null string value will resolve to TRUE here, including the string \"false\" \n        var wfuDebugValue = Boolean(localStorage.getItem(this.localStorageDebugFlag)); \n\n        // Or this with the current debug state\n        // If either is enabled, debugging is on \n        wfuDebugValue = wfuDebugValue || this._enabled; \n\n        return wfuDebugValue;\n    }\n    set enabled(active: boolean) {\n        this._enabled = active;\n    }\n\n\n    // Initialize\n    constructor(label: string) {\n\n        // Save the label, for console logging\n        this._label = label;\n\n    }\n\n\n    // Start a console log group\n    group(name) {\n        if (this.enabled)\n            console.group(name);\n    }\n\n    // End a console log group\n    groupEnd() {\n        if (this.enabled)\n            console.groupEnd();\n    }\n\n    // Log debug data to the console\n    debug(...args: any[]): void {\n\n        if (this.enabled)\n            // Unlimited arguments in a JavaScript function\n            // https://stackoverflow.com/a/6396066\n            console.debug(this._label, ...args); \n            \n    }\n\n    /**\n     * Returns the HTML style string\n     * @param elem The element to return the string for \n     * @returns \n     */\n    static getStyleString(elem: HTMLElement): string {\n\n        let styleString = '';\n    \n        for (let i = 0; i < elem.style.length; i++) {\n            const property = elem.style[i];\n            const value = elem.style.getPropertyValue(property);\n            styleString += `${property}: ${value}; `;\n        }\n    \n        return styleString; \n    }\n\n}\n\n\n", "\n/*\n * webflow-core\n * \n * Sygnal Technology Group\n * http://sygnal.com\n * \n * Designer Utilities\n */\n\nimport { Sa5Attribute } from \"../globals\";\n\n\n\nexport class Sa5Designer {\n\n    constructor() {\n\n    }\n\n    init() {\n        this.removeDesignTimeElements();\n    }\n\n    // Remove any element tagged for design-time-only\n    // used typically for in-designer <style> elements\n    // in HTML Embeds. \n    removeDesignTimeElements() {\n\n// console.log(\"designer clean\"); \n\n        const elements: NodeListOf<HTMLElement> = document.querySelectorAll(\n            Sa5Attribute.getBracketed(Sa5Attribute.ATTR_DESIGN)\n            );\n\n        elements.forEach(element => {\n            element.remove();\n        });\n\n    }\n\n}\n\n\n", "\n/*\n * webflow-core\n * \n * Sygnal Technology Group\n * http://sygnal.com\n * \n * Core Utilities\n */\n\n\n\n// export interface Sa5Handler {\n//     [0]: string;\n//     [1]: Function;\n// }\n\n\nimport { Sa5Attribute } from './globals';\nimport { Sa5Debug } from './webflow-core/debug'\nimport { Sa5Designer } from './webflow-core/designer';\n\n/*\n * SA5 Core\n */\n\nexport class Sa5Core {\n\n    public handlers = [];\n\n    // Returns all handlers found by the specified name\n    getHandlers(name: string): Function[] {\n\n        return this.handlers.filter(item => item[0] === name)\n            .map(item => item[1]);\n    }\n\n    // Returns the first handler found by the specified name\n    getHandler(name: string): Function { \n\n        const item = this.handlers\n            .find(item => item[0] === name);\n        return item ? item[1] : undefined;\n    }\n\n    // Map for elements wired to Sa5 objects \n//    public elements: WeakMap<HTMLElement, object>;\n//     map.set(elem, myObject);\n\n// // Later, you can retrieve the object like this\n// let retrievedObject = map.get(elem);\n\n    constructor() {\n\n        // Remove any designer-only elements\n        (new Sa5Designer).init();    \n\n    }\n\n    init() {\n\n        this.initDebugMode();\n        this.initAsync();\n    }\n\n    async initAsync() {\n\n        this.initScriptInjectionsAsync(); \n\n    }\n\n    async initScriptInjectionsAsync() {\n\n// console.log(\"Sa5\", \"Script injections\"); \n\n        document.addEventListener('DOMContentLoaded', () => {\n\n            const loadSrcScripts = document.querySelectorAll<HTMLScriptElement>(\n                `script[${Sa5Attribute.ATTR_CORE_SCRIPT_INJECT}]`\n                );\n        \n            loadSrcScripts.forEach(script => {\n                const loadSrcUrl = script.getAttribute(Sa5Attribute.ATTR_CORE_SCRIPT_INJECT);\n                \n                if (loadSrcUrl) {\n                    fetch(loadSrcUrl)\n                        .then(response => response.text())\n                        .then(jsContent => {\n                            // Create a new script element and set its content\n                            const newScript = document.createElement('script');\n                            newScript.textContent = jsContent;\n        \n                            // Replace the current script tag with the new one\n                            script.replaceWith(newScript);\n                        })\n                        .catch(error => {\n                            console.error('Error loading script:', error);\n                        });\n                }\n            });\n        });\n        \n    }\n\n    // Auto-enable debug\n    // based on ?sa-debug=true querystring param\n    initDebugMode() {\n\n        const debugParamKey = 'debug'; // ?sa-debug=true\n\n//        var wfuDebugValue = Boolean(localStorage.setItem('wfuDebug', 'true')); \n\n        let params = new URLSearchParams(window.location.search);\n        let hasDebug = params.has(debugParamKey);\n\n        if (hasDebug) {\n            let wfuDebug = new Sa5Debug(`sa5 init`);\n            wfuDebug.persistentDebug = this.stringToBoolean(params.get(debugParamKey));\n        }\n\n    }\n\n    stringToBoolean(str: string): boolean {\n        const truthyValues: string[] = ['1', 'true', 'yes'];\n        const falsyValues: string[] = ['0', 'false', 'no'];\n      \n        if (truthyValues.indexOf(str.toLowerCase()) !== -1) {\n            return true;\n        // } else if (falsyValues.indexOf(str.toLowerCase()) !== -1) {\n        //     return false;\n        } else {\n            return false;\n        }\n    }\n\n    // Factory \n    // Get or create Sa5Core \n    static startup(module: any | null = null): Sa5Core {\n\n//        console.debug(\"sa5core\", \"startup\");\n\n//        console.debug(\"INITIALIZING SA5CORE\");\n//        console.log(window[\"sa5\"]);\n        \n        let sa5instance = window['sa5'];\n\n        var core: Sa5Core; // = new Sa5Core();\n\n        // Initialize Sa5Core if needed\n\n        if(sa5instance?.constructor?.name == \"Sa5Core\") {\n\n            core = sa5instance;\n\n        } else {\n\n    //         if(window[\"sa5\"])\n    // console.log(\"name\", window[\"sa5\"].name);\n\n            core = new Sa5Core();\n            core.init(); \n\n            // Absorb handlers\n            if(Array.isArray(sa5instance))\n                core.handlers = sa5instance; //window[\"sa5\"];\n\n            window[\"sa5\"] = core;\n            window[\"Sa5\"] = window[\"sa5\"];\n//            console.log(\"post\", window[\"sa5\"] instanceof Sa5Core);\n\n        } \n\n        // Add new module\n        //window[\"sa5\"] = window[\"sa5\"] || []; // {};\n        if (module) {\n\n//            console.debug(\"Registered module\", module.name); \n\n            window[\"sa5\"][module.name] = module;\n//            console.log(window[\"sa5\"][module.name]);\n        }\n\n        // instance.constructor.name\n\n        return core;\n    }\n\n    // Add new handlers\n    push(o) {\n        this.handlers.push(o);\n    }\n\n}\n\n\n// Complete initialization \n// even though we don't need it yet \nSa5Core.startup(); \n\n\n// Register\n//window[\"sa5\"] = window[\"sa5\"] || []; // {};\n//window[\"sa5\"][\"Sa5Core\"] = Sa5Core;\n", "\n/*\n * webflow-crypto\n * \n * Sygnal Technology Group\n * http://sygnal.com\n * \n * Hashing & Cryptographic Utilities\n */\n\n// xxhash64 implementation\n// Copyright 2019-2020, Yann Collet <github.com/Cyan4973>\n// Copyright 2016, Pierre Curto <github.com/pierrec>\n// Copyright 2019, Daniel Lo Nigro <github.com/Daniel15>\n// Copyright 2021, intrnl <github.com/intrnl> \n// https://codeberg.org/intrnl/js-xxhash64/src/branch/trunk/src/index.js \n\n\nconst PRIME64_1 = 11400714785074694791n;\nconst PRIME64_2 = 14029467366897019727n;\nconst PRIME64_3 = 1609587929392839161n;\nconst PRIME64_4 = 9650029242287828579n;\nconst PRIME64_5 = 2870177450012600261n;\n\nconst BITS = 64n;\nconst BITMASK = 2n ** BITS - 1n;\n\nconst encoder = new TextEncoder();\n\nfunction bitsToBigInt (a00, a16, a32, a48) {\n\treturn (\n\t\t(BigInt(a00)) |\n\t\t(BigInt(a16) << 16n) |\n\t\t(BigInt(a32) << 32n) |\n\t\t(BigInt(a48) << 48n)\n\t);\n}\n\nfunction memoryToBigInt(memory, offset) {\n\treturn (\n\t\t(BigInt(memory[offset])) |\n\t\t(BigInt(memory[offset+1]) << 8n) |\n\t\t(BigInt(memory[offset+2]) << 16n) |\n\t\t(BigInt(memory[offset+3]) << 24n) |\n\t\t(BigInt(memory[offset+4]) << 32n) |\n\t\t(BigInt(memory[offset+5]) << 40n) |\n\t\t(BigInt(memory[offset+6]) << 48n) |\n\t\t(BigInt(memory[offset+7]) << 56n)\n\t);\n}\n\nfunction rotl (value, rotation) {\n\treturn (\n\t\t((value << rotation) & BITMASK) |\n\t\t(value >> (BITS - rotation))\n\t);\n}\n\nfunction trunc (value) {\n\treturn BigInt.asUintN(64, value);\n}\n\n\nexport class XXH64 {\n\t#seed;\n\t#v1;\n\t#v2;\n\t#v3;\n\t#v4;\n\n\t#memory;\n\n\t#len;\n\t#memsize;\n\n\tconstructor (seed = 0) {\n\t\tthis.reset(seed);\n\t}\n\n\treset (seed = this.#seed) {\n\t\tthis.#seed = BigInt.asUintN(32, BigInt(seed));\n\t\tthis.#v1 = trunc(this.#seed + PRIME64_1 + PRIME64_2);\n\t\tthis.#v2 = trunc(this.#seed + PRIME64_2);\n\t\tthis.#v3 = this.#seed;\n\t\tthis.#v4 = trunc(this.#seed - PRIME64_1);\n\n\t\tthis.#memory = null;\n\n\t\tthis.#len = 0;\n\t\tthis.#memsize = 0;\n\n\t\treturn this;\n\t}\n\n\tupdate (input) {\n\t\tif (typeof input === 'string') {\n\t\t\tinput = encoder.encode(input);\n\t\t}\n\n\t\tlet p = 0;\n\t\tlet len = input.length;\n\t\tlet bEnd = p + len;\n\n\t\tif (len === 0) {\n\t\t\treturn this;\n\t\t}\n\n\t\tthis.#len += len;\n\n\t\tif (this.#memsize === 0) {\n\t\t\tthis.#memory = new Uint8Array(32);\n\t\t}\n\n\t\tif (this.#memsize + len < 32) {\n\t\t\tthis.#memory.set(input.subarray(0, len), this.#memsize);\n\n\t\t\tthis.#memsize += len;\n\t\t\treturn this;\n\t\t}\n\n\t\tif (this.#memsize > 0) {\n\t\t\tthis.#memory.set(input.subarray(0, 32 - this.#memsize), this.#memsize);\n\n\t\t\tlet p64 = 0;\n\t\t\tlet other;\n\n\t\t\tother = memoryToBigInt(this.#memory, p64);\n\t\t\tthis.#v1 = trunc(rotl(trunc(this.#v1 + other * PRIME64_2), 31n) * PRIME64_1);\n\n\t\t\tp64 += 8\n\t\t\tother = memoryToBigInt(this.memory, p64)\n\t\t\tthis.#v2 = trunc(rotl(trunc(this.#v2 + other * PRIME64_2), 31n) * PRIME64_1);\n\n\t\t\tp64 += 8\n\t\t\tother = memoryToBigInt(this.memory, p64)\n\t\t\tthis.#v3 = trunc(rotl(trunc(this.#v3 + other * PRIME64_2), 31n) * PRIME64_1);\n\n\t\t\tp64 += 8\n\t\t\tother = memoryToBigInt(this.memory, p64)\n\t\t\tthis.#v4 = trunc(rotl(trunc(this.#v4 + other * PRIME64_2), 31n) * PRIME64_1);\n\n\t\t\tp += 32 - this.#memsize;\n\t\t\tthis.#memsize = 0;\n\t\t}\n\n\t\tif (p <= bEnd - 32) {\n\t\t\tconst limit = bEnd - 32;\n\n\t\t\tdo {\n\t\t\t\tlet other;\n\n\t\t\t\tother = memoryToBigInt(input, p)\n\t\t\t\tthis.#v1 = trunc(rotl(trunc(this.#v1 + other * PRIME64_2), 31n) * PRIME64_1);\n\t\t\t\tp += 8\n\n\t\t\t\tother = memoryToBigInt(input, p)\n\t\t\t\tthis.#v2 = trunc(rotl(trunc(this.#v2 + other * PRIME64_2), 31n) * PRIME64_1);\n\t\t\t\tp += 8\n\n\t\t\t\tother = memoryToBigInt(input, p)\n\t\t\t\tthis.#v3 = trunc(rotl(trunc(this.#v3 + other * PRIME64_2), 31n) * PRIME64_1);\n\t\t\t\tp += 8\n\n\t\t\t\tother = memoryToBigInt(input, p)\n\t\t\t\tthis.#v4 = trunc(rotl(trunc(this.#v4 + other * PRIME64_2), 31n) * PRIME64_1);\n\t\t\t\tp += 8\n\t\t\t} while (p <= limit)\n\t\t}\n\n\t\tif (p < bEnd) {\n\t\t\tthis.#memory.set(input.subarray(p, bEnd), this.#memsize);\n\t\t\tthis.#memsize = bEnd - p;\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tdigest () {\n\t\tlet input = this.#memory;\n\n\t\tlet bEnd = this.#memsize;\n\t\tlet p = 0;\n\t\tlet h64 = 0n;\n\t\tlet h = 0n;\n\t\tlet u = 0n;\n\n\t\tif (this.#len >= 32) {\n\t\t\th64 = rotl(this.#v1, 1n) + rotl(this.#v2, 7n) + rotl(this.#v3, 12n) + rotl(this.#v4, 18n);\n\n\t\t\th64 = trunc(h64 ^ (rotl(trunc(this.#v1 * PRIME64_2), 31n) * PRIME64_1));\n\t\t\th64 = trunc(h64 * PRIME64_1 + PRIME64_4);\n\n\t\t\th64 = trunc(h64 ^ (rotl(trunc(this.#v2 * PRIME64_2), 31n) * PRIME64_1));\n\t\t\th64 = trunc(h64 * PRIME64_1 + PRIME64_4);\n\n\t\t\th64 = trunc(h64 ^ (rotl(trunc(this.#v3 * PRIME64_2), 31n) * PRIME64_1));\n\t\t\th64 = trunc(h64 * PRIME64_1 + PRIME64_4);\n\n\t\t\th64 = trunc(h64 ^ (rotl(trunc(this.#v4 * PRIME64_2), 31n) * PRIME64_1));\n\t\t\th64 = trunc(h64 * PRIME64_1 + PRIME64_4);\n\t\t}\n\t\telse {\n\t\t\th64 = trunc(this.#seed + PRIME64_5);\n\t\t}\n\n\t\th64 += BigInt(this.#len);\n\n\t\twhile (p <= bEnd - 8) {\n\t\t\tu = memoryToBigInt(input, p);\n\t\t\tu = trunc(rotl(trunc(u * PRIME64_2), 31n) * PRIME64_1);\n\n\t\t\th64 = trunc((rotl(h64 ^ u, 27n) * PRIME64_1) + PRIME64_4);\n\t\t\tp += 8;\n\t\t}\n\n\t\tif (p + 4 <= bEnd) {\n\t\t\tu = bitsToBigInt((input[p+1] << 8) | input[p], (input[p+3] << 8) | input[p+2], 0, 0);\n\t\t\th64 = trunc((rotl(h64 ^ trunc((u * PRIME64_1)), 23n) * PRIME64_2) + PRIME64_3);\n\t\t\tp += 4;\n\t\t}\n\n\t\twhile (p < bEnd) {\n\t\t\tu = bitsToBigInt(input[p++], 0, 0, 0);\n\t\t\th64 = trunc(rotl(h64 ^ trunc(u * PRIME64_5), 11n) * PRIME64_1);\n\t\t}\n\n\t\th = trunc(h64 >> 33n);\n\t\th64 = trunc((h64 ^ h) * PRIME64_2);\n\n\t\th = trunc(h64 >> 29n);\n\t\th64 = trunc((h64 ^ h) * PRIME64_3);\n\n\t\th = trunc(h64 >> 32n);\n\t\th64 = trunc(h64 ^ h);\n\n\t\treturn h64;\n\t}\n\n    static hash (input, seed = 0) {\n        return new XXH64(seed).update(input).digest()\n            .toString(16); // Hex\n    }    \n\n}\n\n\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import \n// https://www.npmjs.com/package/blueimp-md5-es6\n// https://github.com/pvorb/node-md5/issues/52 \n// https://code.tutsplus.com/tutorials/how-to-hash-and-decrypt-with-md5-in-javascript--cms-38297\n// import CryptoJS from ''; \n\n// import * as md5 from 'https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js';\n\n// const toUtf8_1 = require(\"https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/toUtf8.js\");\nconst PRIME32_1 = 2654435761;\nconst PRIME32_2 = 2246822519;\nconst PRIME32_3 = 3266489917;\nconst PRIME32_4 = 668265263;\nconst PRIME32_5 = 374761393;\n\n// https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/toUtf8.js \n\nfunction toUtf8_1(text) {\n    const bytes = [];\n    const w = new Array(4);\n    const h = [0x00, 0xc0, 0xe0, 0xf0];\n    const m = [0x7f, 0x3f, 0x3f, 0x3f];\n    const p = [0x00, 0x80, 0x80, 0x80];\n    for (const char of text) {\n        const b = w;\n        const cp = char.codePointAt(0);\n        const n = 0\n            - ((-(cp & 0xffffff80) >> 31))\n            - ((-(cp & 0xfffff800) >> 31))\n            - ((-(cp & 0xffff0000) >> 31));\n        const z = m[n];\n        const y = p[n];\n        b[3] = y | (cp & z);\n        b[2] = y | ((cp >>> 6) & z);\n        b[1] = y | ((cp >>> 12) & z);\n        b[0] = y | ((cp >>> 18) & z);\n        const s = 3 - n;\n        b[s] |= h[n];\n        Array.prototype.push.apply(bytes, b.slice(s));\n    }\n    return new Uint8Array(bytes);\n}\n\n\n\nexport class XXH32 {\n\n    /**\n     *\n     * @param buffer - byte array or string\n     * @param seed - optional seed (32-bit unsigned);\n     */\n    // https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/xxHash32.js\n\n    static hash(buffer, seed = 0) {\n        buffer = typeof buffer === 'string' ? toUtf8_1(buffer) : buffer;\n        const b = buffer;\n        /*\n            Step 1. Initialize internal accumulators\n            Each accumulator gets an initial value based on optional seed input. Since the seed is optional, it can be 0.\n\n            ```\n                u32 acc1 = seed + PRIME32_1 + PRIME32_2;\n                u32 acc2 = seed + PRIME32_2;\n                u32 acc3 = seed + 0;\n                u32 acc4 = seed - PRIME32_1;\n            ```\n            Special case : input is less than 16 bytes\n            When input is too small (< 16 bytes), the algorithm will not process any stripe. Consequently, it will not\n            make use of parallel accumulators.\n\n            In which case, a simplified initialization is performed, using a single accumulator :\n\n            u32 acc  = seed + PRIME32_5;\n            The algorithm then proceeds directly to step 4.\n        */\n        let acc = (seed + PRIME32_5) & 0xffffffff;\n        let offset = 0;\n        if (b.length >= 16) {\n            const accN = [\n                (seed + PRIME32_1 + PRIME32_2) & 0xffffffff,\n                (seed + PRIME32_2) & 0xffffffff,\n                (seed + 0) & 0xffffffff,\n                (seed - PRIME32_1) & 0xffffffff,\n            ];\n            /*\n                Step 2. Process stripes\n                A stripe is a contiguous segment of 16 bytes. It is evenly divided into 4 lanes, of 4 bytes each.\n                The first lane is used to update accumulator 1, the second lane is used to update accumulator 2, and so on.\n\n                Each lane read its associated 32-bit value using little-endian convention.\n\n                For each {lane, accumulator}, the update process is called a round, and applies the following formula :\n\n                ```\n                accN = accN + (laneN * PRIME32_2);\n                accN = accN <<< 13;\n                accN = accN * PRIME32_1;\n                ```\n\n                This shuffles the bits so that any bit from input lane impacts several bits in output accumulator.\n                All operations are performed modulo 2^32.\n\n                Input is consumed one full stripe at a time. Step 2 is looped as many times as necessary to consume\n                the whole input, except the last remaining bytes which cannot form a stripe (< 16 bytes). When that\n                happens, move to step 3.\n            */\n            const b = buffer;\n            const limit = b.length - 16;\n            let lane = 0;\n            for (offset = 0; (offset & 0xfffffff0) <= limit; offset += 4) {\n                const i = offset;\n                const laneN0 = b[i + 0] + (b[i + 1] << 8);\n                const laneN1 = b[i + 2] + (b[i + 3] << 8);\n                const laneNP = laneN0 * PRIME32_2 + (laneN1 * PRIME32_2 << 16);\n                let acc = ((accN[lane] + laneNP) & 0xffffffff);\n                acc = (acc << 13) | (acc >>> 19);\n                const acc0 = acc & 0xffff;\n                const acc1 = acc >>> 16;\n                accN[lane] = (acc0 * PRIME32_1 + (acc1 * PRIME32_1 << 16)) & 0xffffffff;\n                lane = (lane + 1) & 0x3;\n            }\n            /*\n                Step 3. Accumulator convergence\n                All 4 lane accumulators from previous steps are merged to produce a single remaining accumulator\n                of same width (32-bit). The associated formula is as follows :\n\n                ```\n                acc = (acc1 <<< 1) + (acc2 <<< 7) + (acc3 <<< 12) + (acc4 <<< 18);\n                ```\n            */\n            acc = (((accN[0] << 1) | (accN[0] >>> 31))\n                + ((accN[1] << 7) | (accN[1] >>> 25))\n                + ((accN[2] << 12) | (accN[2] >>> 20))\n                + ((accN[3] << 18) | (accN[3] >>> 14))) & 0xffffffff;\n        }\n        /*\n            Step 4. Add input length\n            The input total length is presumed known at this stage. This step is just about adding the length to\n            accumulator, so that it participates to final mixing.\n\n            ```\n            acc = acc + (u32)inputLength;\n            ```\n        */\n        acc = (acc + buffer.length) & 0xffffffff;\n        /*\n            Step 5. Consume remaining input\n            There may be up to 15 bytes remaining to consume from the input. The final stage will digest them according\n            to following pseudo-code :\n            ```\n            while (remainingLength >= 4) {\n                lane = read_32bit_little_endian(input_ptr);\n                acc = acc + lane * PRIME32_3;\n                acc = (acc <<< 17) * PRIME32_4;\n                input_ptr += 4; remainingLength -= 4;\n            }\n            ```\n            This process ensures that all input bytes are present in the final mix.\n        */\n        let limit = buffer.length - 4;\n        for (; offset <= limit; offset += 4) {\n            const i = offset;\n            const laneN0 = b[i + 0] + (b[i + 1] << 8);\n            const laneN1 = b[i + 2] + (b[i + 3] << 8);\n            const laneP = laneN0 * PRIME32_3 + (laneN1 * PRIME32_3 << 16);\n            acc = ((acc + laneP) & 0xffffffff);\n            acc = (acc << 17) | (acc >>> 15);\n            acc = (((acc & 0xffff) * PRIME32_4) + (((acc >>> 16) * PRIME32_4) << 16)) & 0xffffffff;\n        }\n        /*\n            ```\n            while (remainingLength >= 1) {\n                lane = read_byte(input_ptr);\n                acc = acc + lane * PRIME32_5;\n                acc = (acc <<< 11) * PRIME32_1;\n                input_ptr += 1; remainingLength -= 1;\n            }\n            ```\n        */\n        for (; offset < b.length; ++offset) {\n            const lane = b[offset];\n            acc = acc + lane * PRIME32_5;\n            acc = (acc << 11) | (acc >>> 21);\n            acc = (((acc & 0xffff) * PRIME32_1) + (((acc >>> 16) * PRIME32_1) << 16)) & 0xffffffff;\n        }\n        /*\n            Step 6. Final mix (avalanche)\n            The final mix ensures that all input bits have a chance to impact any bit in the output digest,\n            resulting in an unbiased distribution. This is also called avalanche effect.\n            ```\n            acc = acc xor (acc >> 15);\n            acc = acc * PRIME32_2;\n            acc = acc xor (acc >> 13);\n            acc = acc * PRIME32_3;\n            acc = acc xor (acc >> 16);\n            ```\n        */\n        acc = acc ^ (acc >>> 15);\n        acc = ((acc & 0xffff) * PRIME32_2 & 0xffffffff) + ((acc >>> 16) * PRIME32_2 << 16);\n        acc = acc ^ (acc >>> 13);\n        acc = ((acc & 0xffff) * PRIME32_3 & 0xffffffff) + ((acc >>> 16) * PRIME32_3 << 16);\n        acc = acc ^ (acc >>> 16);\n        // turn any negatives back into a positive number;\n        return acc < 0 ? acc + 4294967296 : acc;\n    }\n\n}\n\n//https://cdnjs.com/libraries/crypto-js\n\n// https://cryptojs.gitbook.io/docs/ \n// https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/md5.min.js \n// https://stackoverflow.com/questions/56280825/crypto-js-module-is-imported-but-does-not-work-as-expected \n// import \"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/core.min.js\";\n//import * as CryptoJS from \"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js\"\n//  import HmacMD5 from \"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/hmac-md5.min.js\";\n\n// import * as CryptoJS from \"https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/md5.js\"; \n\n// import * as XXH from \"https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/xxHash32.js\";\n//import * as xx from \"https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/index.js\"; \n// import { xxHash32 } from \"https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/index.js\";\n// https://cdn.jsdelivr.net/npm/js-xxhash@1.0.4/dist/index.js\n\n// https://github.com/bryc/code/blob/master/jshash/hashes/murmurhash3.js\nfunction MurmurHash3(key, seed = 0) {\n    var k, p1 = 3432918353, p2 = 461845907, h = seed | 0;\n\n    for(var i = 0, b = key.length & -4; i < b; i += 4) {\n        k = key[i+3] << 24 | key[i+2] << 16 | key[i+1] << 8 | key[i];\n        k = Math.imul(k, p1); k = k << 15 | k >>> 17;\n        h ^= Math.imul(k, p2); h = h << 13 | h >>> 19;\n        h = Math.imul(h, 5) + 3864292196 | 0; // |0 = prevent float\n    }\n\n    k = 0;\n    switch (key.length & 3) {\n        case 3: k ^= key[i+2] << 16;\n        case 2: k ^= key[i+1] << 8;\n        case 1: k ^= key[i];\n                k = Math.imul(k, p1); k = k << 15 | k >>> 17;\n                h ^= Math.imul(k, p2);\n    }\n\n    h ^= key.length;\n\n    h ^= h >>> 16; h = Math.imul(h, 2246822507);\n    h ^= h >>> 13; h = Math.imul(h, 3266489909);\n    h ^= h >>> 16;\n\n    return h >>> 0;\n}", "\n/*\n * webflow-membership\n * \n * Sygnal Technology Group\n * http://sygnal.com\n * \n * Member Information Utilities\n */\n\nimport { XXH64 } from './webflow-crypto';\nimport { toTitleCase, getCookie } from './utils';\n\nimport { Sa5Core } from './webflow-core';\nimport { Sa5Debug } from './webflow-core/debug';\nimport { Sa5User } from './webflow-membership/user'; \n\nimport { WfuDataBinder } from './webflow-databind';\nimport { Sa5GlobalEvent } from './globals';\nimport { Sa5UserAccessGroups } from './webflow-membership/access-groups';\nimport { Sa5UserHyperflow } from './webflow-membership/hyperflow';\n\nconst StorageKeys = Object.freeze({\n    user: 'wfuUser', // sa5_user\n    userKey: 'wfuUserKey' // sa5_user_key\n});\n\ntype GetConfigCallback = (Sa5MembershipConfig) \n    => Sa5UserAccountsConfig;\n\ntype UserInfoChangedCallback = (user: Sa5User) => void;\n\n\n\ninterface Sa5UserAccountsConfig {\n//    loadUserInfoCallback?: ((user: Sa5User) => void) | undefined; // Function callback \n    userInfoUpdatedCallback?: UserInfoChangedCallback; \n//    userLogoutPurge?: ((user: Sa5User) => void) | undefined;\n\n    debug?: boolean;\n\n    dataBind?: boolean; // Databind after user object load \n\n    // The name of the folder used to determine access groups \n    // e.g. /_ag/... the default is _ag. \n    accessGroupsFolder?: string;\n\n    // The set of access group slugs that the system has defined \n    accessGroups?: string[];\n\n    // Advanced settings\n    advanced: {\n        accountInfoLoadDelay: number; // ms \n        accountInfoSaveDelay: number; // ms \n    };\n\n    hf: { // Hyperflow\n        enabled: boolean; // false\n        currentUserUrl: string; // '/_hf/users/current_user',\n    }    \n\n}\n\n\n/**\n * User Accounts  \n */\n\nexport class Sa5UserAccounts {\n\n    debug: Sa5Debug;\n\n    config: Sa5UserAccountsConfig; // Optional config\n\n    // Type guard to check if a function is a UserInfoChangedCallback\n    private isUserInfoChangedCallback(func: Function): func is UserInfoChangedCallback {\n\n        if(!func) return false;\n\n        // Adjust this check as needed\n        return func.length === 1;\n    }\n\n    constructor(config: Partial<Sa5UserAccountsConfig> = {}) {\n\n        // Merge configs, with defaults\n        this.config = {\n            userInfoUpdatedCallback: config.userInfoUpdatedCallback,\n            debug: config.debug ?? false,\n            dataBind: config.dataBind ?? true, \n            accessGroupsFolder: config.accessGroupsFolder ?? '/sa5-ag', // TODO: globals  \n            accessGroups: config.accessGroups ?? null, // null means none defined, don't check \n            advanced: {\n                accountInfoLoadDelay: \n                    config.advanced?.accountInfoLoadDelay ?? 300,\n                accountInfoSaveDelay: \n                    config.advanced?.accountInfoSaveDelay ?? 500,\n            },\n            hf: { // Hyperflow \n                enabled: \n                    config.hf?.enabled ?? false,\n                currentUserUrl: \n                    config.hf?.currentUserUrl ?? '/_hf/users/current_user'\n            }\n        }\n\n        let core: Sa5Core = Sa5Core.startup();\n\n        // Initialize debugging\n        this.debug = new Sa5Debug(\"sa5-membership\");\n        this.debug.debug (\"Initializing\");\n\n        // Load config\n\n        // Get any global handler\n//         const userInfoChanged = core.getHandlers(Sa5GlobalEvent.EVENT_USER_CHANGED); \n//         userInfoChanged.forEach((f) => {\n\n// if(this.isUserInfoChangedCallback(f)) {\n\n// }\n\n//         }); \n        // if (this.isUserInfoChangedCallback(userInfoChanged)) {\n\n        //     this.config.userInfoUpdatedCallback = userInfoChanged;\n\n        // }\n\n        // const userInfoChanged = core.getHandler(Sa5GlobalEvent.EVENT_USER_CHANGED); \n        // if (this.isUserInfoChangedCallback(userInfoChanged)) {\n\n        //     this.config.userInfoUpdatedCallback = userInfoChanged;\n\n        // }\n\n        // TODO: Make this a singleton Sa5Core \n\n    }\n\n    onUserInfoChanged(user: Sa5User) {\n\n        let core: Sa5Core = Sa5Core.startup();\n        console.log(core);\n        \n        const userInfoChanged = core.getHandlers(Sa5GlobalEvent.EVENT_USER_CHANGED); \n        userInfoChanged.forEach((f) => {\n\n            if(this.isUserInfoChangedCallback(f)) {\n                f(user); \n            }\n\n        });         \n\n    }\n\n    init() {\n\n        // // Suppress IFRAME loads & user-account page loads \n        // // BUG: \n        // if (window.self != window.top)\n        //     return;\n        // if (window.location.pathname == `/user-account`) \n        //     return;\n\n        this.debug.group(`SA5 UserInfo init - ${Date.now()}.`);\n\n        let core: Sa5Core = Sa5Core.startup();\n\n        // TODO: move label to globals\n        let configHandler: GetConfigCallback = core.getHandler(\"getMembershipConfig\") as GetConfigCallback;\n\n        if(!configHandler) \n            return; // do nothing\n    \n        // this.config.getConfigCallback \n        //     = core.getHandler('getMembershipRoutingConfig') as GetConfigCallback; \n\n        if(configHandler) {\n            this.config = configHandler(\n                this.config\n            ); \n            console.debug(\"USER INFO CONFIG\", this.config); \n        }\n\n        /**\n         * Install listeners\n         * to listen for login/logout events \n         */\n        \n        // https://stackoverflow.com/questions/9347282/using-jquery-preventing-form-from-submitting \n        // https://stackoverflow.com/questions/11469616/jquery-form-validation-before-ajax-submit\n\n        // LOGIN FORMS\n\n        let forms = document.querySelectorAll(\"form[data-wf-user-form-type='login']\");\n        forms.forEach((form) => {\n            form.addEventListener('submit', (e) => {\n                // e.preventDefault();\n                // e.stopPropagation();\n\n                // On a login event, capture and save email temporarily \n                let emailInput = form.querySelector(\"#wf-log-in-email\") as HTMLInputElement;\n                let userEmail = emailInput.value;\n\n                let userKey = btoa(userEmail);\n                localStorage.setItem('StorageKeys.userKey', userKey); \n            });\n        });\n\n        // USER-ACCOUNT FORMS\n\n        forms = document.querySelectorAll(\"form[data-wf-user-form-type='userAccount']\");     \n        forms.forEach((form) => {\n            // Add a submit event listener\n            form.addEventListener('submit', (e) => {\n                // e.preventDefault();\n                // e.stopPropagation();\n\n                setTimeout(async () => {\n\n                    // Refresh user info\n                    await this.loadUserInfoAsync();\n\n                }, this.config.advanced.accountInfoSaveDelay);\n\n            });\n        });\n\n        // Call on every page on load.\n        this.readyUserInfo();\n\n        this.debug.groupEnd();\n    \n    }\n\n    // Determine whether Webflow has a \n    // currently logged-in user, by cookie detection \n    isLoggedIn() {\n\n        return getCookie(\"wf_loggedin\") || false;\n    }\n\n    clearUserInfo() {\n\n        this.debug.group(\"clearUserInfo\");\n\n        this.debug.debug (\"logged out, cleaning info.\"); \n        \n        sessionStorage.removeItem(StorageKeys.user); \n        localStorage.removeItem(StorageKeys.userKey); \n\n        // Notify listeners \n        // if (this.config.userLogoutPurge)\n        //     this.config.userLogoutPurge(); // async \n\n            this.debug.groupEnd();\n\n    }\n\n    // setDomainCookie = function(key, value, expires) {\n\n    //     const domain = location.hostname;\n\n    // }\n\n    // Loads user info, from local and server data.\n    // readying it for use. \n    // Should be called on every page at the start. \n    async readyUserInfo() {\n\n        this.debug.group(\"readyUserInfo\");\n        \n        // If not logged in\n        // clear user tracking \n        if(!this.isLoggedIn()) { \n            this.clearUserInfo(); \n\n            this.debug.groupEnd();\n            return;\n        }\n    \n        // Load or create blank\n        var user = this.loadUserInfoCache();\n        if (user) {\n\n            // Databinding\n            if(this.config.dataBind) {\n                this.debug.debug(\"databinding\", user);\n                new WfuDataBinder(null, {\n                    user: user\n                }).bindAll(); \n            }\n\n            // User Callback \n            this.onUserInfoChanged(user);\n            // if (this.config.userInfoUpdatedCallback) {\n            //     this.debug.debug(\"userCallback\", user);\n            //     this.config.userInfoUpdatedCallback(user); // async\n            // }\n\n        }\n\n        // If no cached user, load it \n        if (!user)\n            // user = \n            await this.loadUserInfoAsync();\n\n        this.debug.groupEnd();\n\n    }\n\n    async getUserKey() {\n\n        var userKey;\n        \n        // Get cached version if possible\n        const userKeyEncoded = localStorage.getItem(StorageKeys.userKey);\n        if (userKeyEncoded) {\n            return atob(userKeyEncoded);\n        }\n\n    }\n\n    //#region CONSTRUCT USER INFO OBJECT\n\n    // Loads user info, from local and server data.\n    // readying it for use. \n    // Should be called on every page at the start. \n    async loadUserInfoAsync() {\n\n        this.debug.group(\"loadUserInfoAsync\");\n        this.debug.debug(`isLoggedIn = ${this.isLoggedIn()}`); \n        \n        // If not logged in\n        // clear user tracking \n        if(!this.isLoggedIn()) { \n            this.clearUserInfo(); \n\n            this.debug.groupEnd();\n            return;\n        }\n\n        // Remove cached user object\n        sessionStorage.removeItem(StorageKeys.user);\n\n        if (this.config.hf.enabled) {\n\n            // Use Hyperflow loader\n            this.loadUserInfoAsync_hyperflow(); // async\n\n        } else {\n\n            // Load layers asynchronously\n            // for maximum performance\n            // merge dynamically as results are gathered\n            this.loadUserInfoAsync_loginInfo(); // async\n            this.loadUserInfoAsync_accountInfo(); // async\n            this.loadUserInfoAsync_accessGroups(); // async\n        \n        }\n\n        // Load or create blank\n\n        this.debug.groupEnd();\n\n    }\n\n    // Get account info\n    // from Hyperflow \n    async loadUserInfoAsync_hyperflow() { \n\n        this.debug.group(\"loadUserInfoAsync_hyperflow\");\n     \n        // Create blank\n        var user = new Sa5User();\n        user.user_data_loaded.email = true;\n        user.user_data_loaded.account_info = true;\n        user.user_data_loaded.access_groups = true;\n\n        const hf: Sa5UserHyperflow = new Sa5UserHyperflow(this);\n\n        await hf.initAsync();\n\n        // const userKey = await this.getUserKey();\n        // if (!userKey) {\n        //     // Logged in but no userKey\n        //     // Typically happens on first login from sign-up auth \n        //     this.debug.debug(\"No user key for loading.\"); \n\n        //     this.debug.groupEnd();\n        //     return;\n        // }\n\n        // // Loaded successfully\n\n        // user.email = userKey;\n\n        // Cache locally (email only)\n        this.debug.debug(\"Caching user object [login].\", user);\n        this.saveUserInfoCache(user); \n\n        // // Hydrate user object with other data \n        // if (this.config.loadUserInfoCallback) {\n        //     await this.config.loadUserInfoCallback(user);\n\n        //     // Cache locally ( updated )\n        //     this.saveUserInfoCache(user); \n        // }\n\n        // Notify listeners\n        // if (this.config.userInfoUpdatedCallback)\n        //     this.config.userInfoUpdatedCallback(user); // async\n\n        this.debug.groupEnd();\n    }\n\n    // Get account info\n    // from cache \n    async loadUserInfoAsync_loginInfo() { \n\n        this.debug.group(\"loadUserInfoAsync_loginInfo\");\n     \n        // Create blank\n        var user = new Sa5User();\n        user.user_data_loaded.email = true;\n\n        const userKey = await this.getUserKey();\n        if (!userKey) {\n            // Logged in but no userKey\n            // Typically happens on first login from sign-up auth \n            this.debug.debug(\"No user key for loading.\"); \n\n            this.debug.groupEnd();\n            return;\n        }\n\n        // Loaded successfully\n\n        user.email = userKey;\n\n        // Cache locally (email only)\n        this.debug.debug(\"Caching user object [login].\", user);\n        this.saveUserInfoCache(user); \n\n        // // Hydrate user object with other data \n        // if (this.config.loadUserInfoCallback) {\n        //     await this.config.loadUserInfoCallback(user);\n\n        //     // Cache locally ( updated )\n        //     this.saveUserInfoCache(user); \n        // }\n\n        // Notify listeners\n        // if (this.config.userInfoUpdatedCallback)\n        //     this.config.userInfoUpdatedCallback(user); // async\n\n        this.debug.groupEnd();\n    }\n\n    // Get account info \n    // from /user-account page \n    async loadUserInfoAsync_accountInfo() {\n\n        this.debug.group(\"loadUserInfoAsync_accountInfo\");\n\n        // Suppress IFRAME loads & user-account page loads \n        if (window.self != window.top) {\n            return;\n        }\n\n        // Create the iframe element\n        let userInfoPixel = document.createElement('iframe');\n        userInfoPixel.src = \"/user-account\";\n        userInfoPixel.id = \"userInfoPixel\";\n        userInfoPixel.style.display = \"none\";\n\n        // Append the iframe to the body\n        document.body.append(userInfoPixel);\n\n        // Add a \"load\" event listener\n        userInfoPixel.addEventListener(\"load\", async () => {\n\n            this.debug.debug(\"Loading user account info.\"); \n            this.debug.debug(`%c here`, \"color: #ff0000; background-color: yellow;\"); \n\n            // Create blank\n            var user = new Sa5User();\n            user.user_data_loaded.email = true; \n            user.user_data_loaded.account_info = true; \n            user.user_data_loaded.custom_fields = true; \n\n//            user.user_data_loaded.access_groups = true;\n\n//             var $userAccountEmail = await userInfoPixel.contents().find(\"input#wf-user-account-email\");\n\n            let userAccountEmailInput: HTMLInputElement | null = null;\n\n            if (userInfoPixel.contentDocument) {\n                userAccountEmailInput = userInfoPixel.contentDocument.querySelector(\"input#wf-user-account-email\");\n            } else if (userInfoPixel.contentWindow) {\n                userAccountEmailInput = userInfoPixel.contentWindow.document.querySelector(\"input#wf-user-account-email\");\n            }\n            \n            if (!userAccountEmailInput) {\n                return;\n            }\n            \n            // Detect programmatic changes on input type text [duplicate]\n            // https://stackoverflow.com/a/72223895\n            const input = userAccountEmailInput; // $userAccountEmail[0];\n            const desc = Object.getOwnPropertyDescriptor(HTMLInputElement.prototype, \"value\");\n            Object.defineProperty(input, \"value\", {\n                get: desc.get,\n                set: function(v) {\n\n                    desc.set.call(this, v);\n\n                    // How can I trigger an onchange event manually? [duplicate]\n                    // https://stackoverflow.com/a/2856602\n                    if (\"createEvent\" in document) {\n\n                        var evt = document.createEvent(\"HTMLEvents\");\n                        evt.initEvent(\"change\", false, true);\n                        input.dispatchEvent(evt);\n\n                    } else {\n\n                        if (userAccountEmailInput) {\n                            // Create a new event\n                            let event = new Event('change', {\n                              bubbles: true,\n                              cancelable: true\n                            });\n                          \n                            // Dispatch the event\n                            userAccountEmailInput.dispatchEvent(event);\n                          }\n                          \n                    }\n//                    input.fireEvent(\"onchange\");\n\n                }\n            });\n\n            // setting up input change event \n            userAccountEmailInput.addEventListener(\"change\", async () => {\n\n                this.debug.debug(\"email field load detected.\");\n\n                this.debug.debug(`waiting ${this.config.advanced.accountInfoLoadDelay}ms`);\n\n                setTimeout(async () => {\n\n                    this.debug.debug(`%c USER-ACCOUNT LOADED`, \"color: #ff0000; background-color: yellow;\"); \n\n                    const userKey = userAccountEmailInput.value;\n\n                    user.email = userKey;\n\n                    // Get pixel \n                    let doc = userInfoPixel.contentDocument || userInfoPixel.contentWindow?.document;\n\n                    if (doc) {\n\n                        let userNameElement = doc.querySelector(\"[data-wf-user-field='wf-user-field-name']\") as HTMLInputElement;\n                        if (userNameElement) {\n                            user.name = userNameElement.value;\n                        }\n                        \n                        // Accept_communications, if defined \n                        let acceptCommunicationsCheckbox = doc.querySelector(\"#wf-user-account-accept-communications\") as HTMLInputElement;\n                        if (acceptCommunicationsCheckbox) {\n                            user.accept_communications = acceptCommunicationsCheckbox.checked;\n                        }\n                        \n                        // User data fields, if defined \n                        let userDataFields = doc.querySelectorAll(\"[data-wf-user-field]\");\n                        userDataFields.forEach((element) => {\n\n                            const id = element.id; \n                            const fieldType = element.getAttribute(\"data-wf-user-field-type\"); \n                            let val = (element as HTMLInputElement).value;\n\n                            if (!id)\n                                return;\n\n                            if (id.startsWith(\"wf-user-account-\"))\n                                return;\n\n                            switch(fieldType) {\n                                case \"PlainText\": // 256 char max \n                                case \"Email\":\n                                case \"Link\":\n                                case \"Option\":\n                                    user.data[id] = val;\n                                    return;\n\n                                case \"Number\": // step min max\n                                    user.data[id] = val; \n                                    return;\n\n                                case \"Bool\": // checkbox\n                                    let checkbox: HTMLInputElement = element as HTMLInputElement;\n                                    user.data[id] = checkbox.checked; \n                                    return;\n\n                                case \"FileRef\": // file - suppressed \n                                    break;\n                            }\n\n                        });\n\n                    }\n\n                    this.debug.debug(\"Final version\", user); \n\n                    // Cache locally (email only)\n                    this.debug.debug(\"Caching user object [account_info].\", user);\n                    this.saveUserInfoCache(user); \n            \n                    // // Hydrate user object with other data \n                    // if (this.config.loadUserInfoCallback) {\n                    //     await this.config.loadUserInfoCallback(user);\n            \n                    //     // Cache locally ( updated )\n                    //     this.saveUserInfoCache(user); \n                    // }\n            \n                    // // Notify listeners\n                    // if (that.config.userInfoUpdatedCallback)\n                    //     that.config.userInfoUpdatedCallback(user); // async\n\n                }, this.config.advanced.accountInfoLoadDelay\n                );\n\n            });\n\n            this.debug.groupEnd();\n        }); \n\n    }\n\n    async loadUserInfoAsync_accessGroups() {\n\n        this.debug.group(\"loadUserInfoAsync_accessGroups\");\n\n        // Create blank\n        var user = new Sa5User();\n        user.user_data_loaded.access_groups = true;\n\n        // If null or [], exit \n        if(this.config.accessGroups) { \n\n            let accessGroupHandler: Sa5UserAccessGroups = new Sa5UserAccessGroups(this);\n            await accessGroupHandler.initAsync(); \n\n            user.access_groups = accessGroupHandler.accessGroups;\n\n        } else {\n            this.debug.debug(\"Access groups not configured.\");\n        }\n\n        // Cache locally (email only)\n        this.debug.debug(\"Caching user object [login].\", user);\n        this.saveUserInfoCache(user); \n\n        this.debug.groupEnd();\n\n    }\n\n    //#endregion\n\n    //#region USER CACHE\n\n    saveUserInfoCache(newUserData) {\n        \n        this.debug.group(\"saveUserInfoCache\");\n\n        if(!this.isLoggedIn) {\n            this.debug.debug(\"no user logged in.\"); \n            this.debug.groupEnd();\n            return null; \n        }\n\n        // Smart merge \n        // https://www.javascripttutorial.net/object/javascript-merge-objects/ \n        // https://masteringjs.io/tutorials/fundamentals/merge-two-objects \n        var userData = this.loadUserInfoCache();\n        if (!userData)\n            userData = new Sa5User();\n\n        if (newUserData.user_data_loaded.email) {\n            this.debug.debug(\"Merging user email.\");\n            userData.email = newUserData.email;\n        }\n        if (newUserData.user_data_loaded.account_info) {\n            this.debug.debug(\"Merging user account_info.\");\n            userData.email = newUserData.email;\n            userData.name = newUserData.name;\n            userData.accept_communications = newUserData.accept_communications;\n        }\n        if (newUserData.user_data_loaded.custom_fields) {\n            this.debug.debug(\"Merging user custom_fields.\");\n            userData.data = newUserData.data; \n        }\n        if (newUserData.user_data_loaded.access_groups) {\n            this.debug.debug(\"Merging user access_groups.\");\n            userData.access_groups = newUserData.access_groups; \n        }\n\n        // Coalesce loaded info \n        userData.user_data_loaded.email = userData.user_data_loaded.email || newUserData.user_data_loaded.email;\n        userData.user_data_loaded.account_info = userData.user_data_loaded.account_info || newUserData.user_data_loaded.account_info;\n        userData.user_data_loaded.custom_fields = userData.user_data_loaded.custom_fields || newUserData.user_data_loaded.custom_fields;\n        userData.user_data_loaded.access_groups = userData.user_data_loaded.access_groups || newUserData.user_data_loaded.access_groups;\n\n        this.debug.debug(\"new user\", newUserData);\n\n        this.debug.debug(\"merged\", userData); // Merged \n\n        sessionStorage.setItem(StorageKeys.user,\n            btoa(JSON.stringify(userData)) // , jsonMapReplacer))\n            ); \n\n        // Databinding\n        if(this.config.dataBind) {\n            this.debug.debug(\"databinding\", userData);\n            new WfuDataBinder(\n                null, // datastore \n                {\n                    user: userData\n                }).bindAll(); \n        }\n\n        // Notify listeners \n//        console.log(\"%cchecking for handler\", \"background-color: yellow;\");\n\n        this.onUserInfoChanged(userData);\n\n//         if (this.config.userInfoUpdatedCallback) {\n// //            console.log(\"%ccalling handler\", \"background-color: yellow;\");\n//             this.debug.debug(\"Notify listeners\", userData); // Merged \n\n//             this.userInfoUpdatedCallback(userData); \n// //            this.config.userInfoUpdatedCallback(userData); // async\n//         }\n//this.userInfoUpdatedCallback\n        this.debug.groupEnd();\n    }\n\n    loadUserInfoCache() { \n\n        this.debug.group(\"loadUserInfoCache\");\n\n        if(!this.isLoggedIn) {\n            this.debug.debug(\"No user logged in.\");\n            this.debug.groupEnd();\n            return null; \n        }\n\n        const userInfo = sessionStorage.getItem(StorageKeys.user); \n\n        if(!userInfo) {\n            this.debug.debug(\"No user info to load.\");\n            this.debug.groupEnd();\n            return null;\n        } \n\n        this.debug.debug(userInfo);\n        this.debug.debug(\"getting user.\"); \n\n        // De-serialize User \n        const user = new Sa5User();\n        user.fromJSON(\n           JSON.parse(atob(userInfo)) //, jsonMapReviver)\n        );\n\n        this.debug.groupEnd();\n\n        return user;\n    } \n\n    //#endregion\n\n    //#region MEMBERSHIPS UX\n\n    // Expanded login button\n    // Used on a containing DIV to expand the trigger area of \n    // Webflow's Log-In / Log-Out button  \n\n    expandLoginButton(elem: HTMLElement) {\n\n        // Get Webflow Login/Logout button\n        const wfLoginButton: HTMLElement = elem.querySelector(\"[data-wf-user-logout]\");\n    \n        // Setup click event handler on outer DIV\n        elem.addEventListener('click', () => {\n            // Click inner element\n            if (wfLoginButton) {\n                wfLoginButton.click();\n            }\n        });\n    \n        // Also intercept and stop propagation so event is not doubled\n        if (wfLoginButton) {\n            wfLoginButton.addEventListener('click', (e: Event) => {\n                e.stopPropagation();\n            });\n        }\n    }\n    \n    //#endregion\n\n    //#region EVENT\n\n    // User Info Updated\n    userInfoUpdatedCallback = ((user: Sa5User) => { \n\n//        console.log(\"%ccalled handler\", \"background-color: yellow;\", user);\n\n        // Notify any config-specified handler\n        if(this.config.userInfoUpdatedCallback) \n            this.config.userInfoUpdatedCallback(\n                user\n            ); \n\n    });\n\n    //#endregion\n\n/*\n// https://jwt.io/ \n// How to decode jwt token in javascript without using a library?\n// https://stackoverflow.com/a/38552302 \n// https://www.npmjs.com/package/jwt-decode\nfunction parseJwt (token) {\n    var base64Url = token.split('.')[1];\n    var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');\n    var jsonPayload = decodeURIComponent(window.atob(base64).split('').map(function(c) {\n        return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);\n    }).join(''));\n\n    return JSON.parse(jsonPayload);\n}\n*/\n\n}\n", "\n/*\n * Sygnal Technology Group\n * http://sygnal.com\n *\n * Data-binding functions.\n */\n\n//import { csvToObjects } from './webflow-data-csv.js';\n//import { prepareCollectionListDataSource } from '../datasources/webflow-collectionlist-data.js';\n//import { loadGoogleSheetFromSpec } from '../datasources/google-sheet-data.js';\nimport { HtmlBuilder } from './webflow-html-builder';\n\n//import { Database } from './webflow-data.js';\nimport { Sa5UserAccounts } from './webflow-membership';\nimport { Sa5User } from './webflow-membership/user';\nimport { booleanValue, getCookie, identifyElement, selectOptionByValue } from './utils'; \n//import Handlebars from \"handlebars\";\nimport { HandlebarsTemplateHandler } from './webflow-databind/template/handlebars-template-handler';\nimport { DefaultTemplateHandler } from './webflow-databind/template/default-template-handler';\nimport { Sa5Datastore } from './webflow-data';\nimport { Sa5Attribute } from './globals';\n\n/*\n * DATA BINDER\n */\n\n// const DataSourceType = Object.freeze({\n//     db: 'db', // + // $db\n//     user: 'user', // @ // $user\n//     query: 'query', // ? // $query\n//     // cookie\n//     // local/session \n\n// });\n\nenum DataSourceTypeEnum {\n    DB = 'db', // + // $db\n    USER = 'user', // @ // $user\n    URL = 'url', // $url\n    QUERY = 'query', // ? // $query\n    LOCAL_STORAGE = 'local', // $local\n    SESSION_STORAGE = 'session', // $session\n    COOKIE = 'cookie', // $cookie\n}\n\n\n// function getKeyByValue(enumObj: any, value: string) {\n//     return Object.keys(enumObj).find(key => enumObj[key] === value);\n// }\n// function getDataSourceTypeEnum(myEnum, enumValue){\n//     let keys = Object.keys(myEnum).filter(x => myEnum[x] == enumValue);\n//     return keys.length > 0 ? keys[0] : null;\n// }\n\ninterface Sa5DataBinderConfig {\n\n    db?: string;\n    user?: Sa5User;\n    handlers: [];\n\n}\n\n// var dataBinderConfig = {\n//     db: undefined,\n//     user: undefined,\n//     handlers: [\n//     ]\n// }\n\nexport class Sa5DataSourceDescriptor {\n    \n    type: DataSourceTypeEnum;\n\n    name: string;\n\n    identifier: string;\n    identifierParts: string[];\n\n    get isValid(): boolean {\n        if (!this.name) return false;\n        if (!this.type) return false;\n        return true;\n    }\n\n    constructor(dataSourceDescriptor: string) {\n\n        this.parse(dataSourceDescriptor); \n    }\n\n    expandDataSourceTypeAbbr(dsd: string): string { \n\n        const DSN_TYPE_ABBR = {\n\n            \"@\": \"$user\",\n            \"+\": \"$db\",\n            \"?\": \"$query\",\n\n             // Reserved for future use\n            \"!\": \"$unknown\", \n            \"#\": \"$unknown\",\n            \"%\": \"$unknown\",\n            \"^\": \"$unknown\",\n            \"&\": \"$unknown\",\n            \"*\": \"$unknown\",\n            \"=\": \"$unknown\",\n            \"-\": \"$unknown\",\n            \"~\": \"$unknown\",\n            // / < > ; : \\ _  \n\n        };        \n\n        if (DSN_TYPE_ABBR.hasOwnProperty(dsd[0])) {\n            return DSN_TYPE_ABBR[dsd[0]] + '.' + dsd.slice(1);\n        }\n\n        return dsd;\n    }\n\n    // Parse the type of the dsn\n    parse(dsd: string): void {\n\n        this.name = undefined;\n        this.type = undefined;\n\n        // Clean whitespace \n        dsd = dsd.trim();\n\n        // If DSN Type is abbr, expand it\n        dsd = this.expandDataSourceTypeAbbr(dsd); \n\n        let parts = dsd.split('.');\n\n        // Resolve to type\n        // Extract & prepare DSN type part\n        var dsnTypeName = parts.shift(); \n\n        if(dsnTypeName[0] != '$') {\n            return; // bad DSD \n        }\n\n        dsnTypeName = dsnTypeName.slice(1); \n\n        // Parts \n        this.identifierParts = parts;\n        this.name = this.identifierParts.join('.');\n\n//        console.log(\"parse\", this.type, dsnTypeName); \n\n        // function getKeyByValue(value: string): DataSourceTypeEnum {\n        //     return Object.keys(DataSourceTypeEnum).find(key => DataSourceTypeEnum[key] === value) as DataSourceTypeEnum;\n        // }\n\n        this.type = dsnTypeName as DataSourceTypeEnum;\n\n//        this.type = getKeyByValue(dsnTypeName);\n\n        // let keys = Object.keys(DataSourceTypeEnum).filter(x => DataSourceTypeEnum[x] == dsnTypeName);\n        // this.type = (keys.length > 0 ? keys[0] : null) as DataSourceTypeEnum;\n\n//        console.log(\"parse after type\", this.type, DataSourceTypeEnum.QUERY);\n\n//console.log(this); \n\n    }\n\n}\n\nexport class WfuDataBinder {\n\n    store: Sa5Datastore;\n\n    config: Sa5DataBinderConfig; // config\n\n    constructor(store: Sa5Datastore, config: Partial<Sa5DataBinderConfig> = {}) {\n\n        this.store = store;\n\n//          this.config = $.extend({}, dataBinderConfig, config);\n//        this.config = {...dataBinderConfig, ...config};\n        // Merge configs, with defaults\n        this.config = {\n//            userInfoUpdatedCallback: config.userInfoUpdatedCallback,\n            db: config.db ?? null,\n            user: config.user ?? null,\n            handlers: [], \n        }\n    \n        // If no user found, load the current one if available\n        if (!this.config.user)\n            this.config.user = new Sa5UserAccounts().loadUserInfoCache();\n\n    }\n\n\n\n    /* Bind all data sources\n    * tagged with [wfu-bind]\n    */\n    bindAll() {\n\n// NOCODE layer\n// Build datasources\n// find elements\n// do binding \n//      passing elements and datasources db \n\n// console.log(\"DATABINDING\"); \n\n        // BUG?? should be in nocode? \n        // Find all elements which specify a data-source for data binding\n        // Iterate and bind each individually\n        let dataBind = document.querySelectorAll(\n            `[${Sa5Attribute.ATTR_DATABIND}]`); // wfu-bind\n        dataBind.forEach((elem: HTMLElement) => {\n\n            // Data-bind element\n            this.bind(elem); \n\n            // Remove preloader attr, if existing\n            elem.removeAttribute(Sa5Attribute.ATTR_PRELOAD); \n\n        }); \n\n        // Bind content \n        let dataBindContent = document.querySelectorAll(\n            `[${Sa5Attribute.ATTR_DATABIND_CONTENT}]`); // wfu-bind-content \n        dataBindContent.forEach((elem: HTMLElement) => {\n\n            // Data-bind content in element\n            this.bindContent(elem); \n\n            // Remove preloader attr, if existing\n            elem.removeAttribute(Sa5Attribute.ATTR_PRELOAD); \n\n        }); \n\n    }\n\n    // Search upward through the DOM for a context for this element \n    // typically used for [wfu-bind-dsn] and [wfu-bind-item-id]\n    findContextSetting(element: HTMLElement, attr: string) {\n        while (element) {\n            if (element.getAttribute(attr) !== null) {\n              return element.getAttribute(attr);\n            }\n            element = element.parentElement;\n        }\n        return null; // no context found\n    }\n\n    // Data-bind element\n    bind(elem: HTMLElement) {\n\n        // Determine bind type \n        let dsnDescriptor = elem.getAttribute(Sa5Attribute.ATTR_DATABIND); // \"wfu-bind\" \n\n        let dsn = new Sa5DataSourceDescriptor(dsnDescriptor); \n\n        // is valid \n        if(!dsn.isValid) {\n            console.error(\"Invalid dsn.\", dsn);\n            return; \n        }\n\n        // Get data\n        let val: string = null;\n        val = this.getData(\n            dsn, \n            elem // as additioanl context, e.g. [wfu-bind-dsn] and [wfu-bind-item-id] contexts \n            ); \n\n        // Handle null situation \n        // BUG: differentiate no result v. empty result \n        if (!val) return;\n\n        // Bind data\n        switch(identifyElement(elem)) {\n            case 'HTMLLinkElement':\n\n                (elem as HTMLLinkElement).href = val;\n\n                break;\n            case 'HTMLCheckboxElement':\n\n                (elem as HTMLInputElement).checked = booleanValue(val);\n\n                break;\n            case 'HTMLRadioElement':\n                break;\n            case 'HTMLFileInputElement':\n                break;\n            case 'HTMLInputElement':\n\n                (elem as HTMLInputElement).value = val;\n\n                break;\n            case 'HTMLSelectElement':\n\n                selectOptionByValue(\n                    (elem as HTMLSelectElement),\n                    val\n                );\n\n                break;\n            case 'HTMLTextAreaElement':\n\n                (elem as HTMLInputElement).value = val;\n\n                break;\n            case 'HTMLButtonElement':\n                break;\n            default:\n\n                // Bind other element \n                elem.textContent = val;\n\n                break;\n\n        }\n\n    }\n    \n    // Binds content in a template \n    bindContent(elem: HTMLElement) {\n\n        new DefaultTemplateHandler(this).processElement(elem);\n\n    }\n\n    // Resolve the DSD to a value \n    // or null if none found  \n    getData(dsd: Sa5DataSourceDescriptor, elem: HTMLElement = null): string {\n\n// console.log(\"getdata dsd\", dsd); \n// console.log(\"getdata dsd.type\", dsd.type, DataSourceTypeEnum.QUERY); \n\n        switch(dsd.type) {\n            case DataSourceTypeEnum.USER:\n                return this.getData_user(\n                    dsd\n                );\n            case DataSourceTypeEnum.DB:\n\n                let dsnContext = this.findContextSetting(elem, \n                    Sa5Attribute.ATTR_DATABIND_CONTEXT_DSN ); // \"wfu-bind-dsn\"\n                let itemContext = this.findContextSetting(elem, \n                    Sa5Attribute.ATTR_DATABIND_CONTEXT_ITEM_ID ); // \"wfu-bind-item-id\" \n\n                // if(elemContext) {\n                //     dsnContext = elemContext.getAttribute(\"wfu-bind-dsn\");\n                //     itemContext = elemContext.getAttribute(\"wfu-bind-item-id\");\n                // }\n\n                // console.log(\"getData db elem\", elemContext); \n                // console.log(\"getData db\", dsnContext, itemContext); \n\n                return this.getData_db(\n                    dsd,\n                    dsnContext,\n                    itemContext\n//                    this.config.db,\n                );\n            case DataSourceTypeEnum.QUERY:\n                return this.getData_query(\n                    dsd\n                );\n            case DataSourceTypeEnum.URL:\n                return this.getData_url(\n                    dsd\n                );\n            case DataSourceTypeEnum.LOCAL_STORAGE:\n                return this.getData_localStorage(\n                    dsd\n                );\n            case DataSourceTypeEnum.SESSION_STORAGE:\n                return this.getData_sessionStorage(\n                    dsd\n                );\n            case DataSourceTypeEnum.COOKIE:\n                return this.getData_cookieStorage(\n                    dsd\n                );\n        } \n\n    } \n\n    private getData_user(dsd: Sa5DataSourceDescriptor): string {\n\n        // If no user, return nothing\n        // TODO: warn? \n        if (!this.config.user || !this.config.user.email)\n            return null; \n    \n        let val: string = \"\";\n        switch (dsd.identifierParts[0]) {\n            case \"data\":\n                val = this.config.user.data[dsd.identifierParts[1]];\n                break;\n            default:\n                val = this.config.user[dsd.name]; \n                break;\n        }\n\n        return val;\n    }\n\n    private getData_cookieStorage(dsd: Sa5DataSourceDescriptor): string {\n\n        // Abort if not in a browser context \n        if (typeof window == 'undefined')\n            return null;\n\n        // Should return null if there is none\n        return getCookie(dsd.name);\n    }\n\n    private getData_localStorage(dsd: Sa5DataSourceDescriptor): string {\n\n        // Abort if not in a browser context \n        if (typeof window == 'undefined')\n            return null;\n\n        // Should return null if there is none\n        return localStorage.getItem(dsd.name);\n    }\n\n    private getData_sessionStorage(dsd: Sa5DataSourceDescriptor): string {\n\n        // Abort if not in a browser context \n        if (typeof window == 'undefined')\n            return null;\n\n        // Should return null if there is none\n        return sessionStorage.getItem(dsd.name);\n    }\n    \n    private getData_query(dsd: Sa5DataSourceDescriptor): string {\n\n        // Abort if not in a browser context \n        if (typeof window == 'undefined')\n            return null;\n        \n        // Get Params \n        let urlParams = new URLSearchParams(window.location.search);\n\n        // Should return null if there is none\n        return urlParams.get(dsd.name);\n    }\n    \n    private getData_url(dsd: Sa5DataSourceDescriptor): string {\n\n        // Abort if not in a browser context \n        if (typeof window == 'undefined')\n            return null;\n        \n        // Get Params \n//        let urlParams = new URLSearchParams(window.location.search);\n\n        const url = new URL(window.location.href);\n\n//        const fieldName = 'pathname';  // This is the string representing the field name\n        \n        const fieldValue = url[dsd.name];\n        \n        console.log(fieldValue);  // Outputs: \"/path/to/resource\"\n        \n\n        // Should return null if there is none\n        return fieldValue; // urlParams.get(dsd.name);\n    }\n\n    private getData_db(dsd: Sa5DataSourceDescriptor, dsnContext: string, itemContext: string): string {\n\n        // Get data source name \n//        let dsn = el.getAttribute(\"wfu-bind\");\n //   console.log(\"getData_db\", dsd, dsnContext, itemContext);\n        // Find all elements which identify themselves\n        // as a data-source\n        //let dataSource = document.querySelector(`*[wfu-bind='${dsn}']`);\n        //if (!dataSource) {\n        //    console.warn(`Datasource: '${name}' does not exist`);\n        //    return;\n        //}\n\n//console.log(this.store);\n\n    let db = this.store.store[dsnContext]\n//    console.log(this.store);\n\n    let item = db.data.get(itemContext);\n\n //   console.log(item); \n\nreturn item[dsd.name];\n\n\n        // BUG: \n// return 'foo';\n\n/* \n\n        // Get data\n        let data = db.getData(dsn);\n    \n        if(!db) {\n            console.warn(`Data binding requested for elem '${data}', but no db defined.`);\n            return; // exit \n        }\n    \n        let templateId = el.getAttribute(\"wfu-bind-template\");\n    \n        let template: HTMLElement = document.querySelector(\"#\" + templateId);\n    \n        let hb = new HtmlBuilder();\n        hb.addTemplate(\n            template,\n            data\n        );\n    \n        // Push HTML to element\n        el.innerHTML = hb.render();\n\n        */\n    }\n\n}\n\n", "\n/**\n * SA5 \n * Default Template Handler \n * Data-Binding Content Template Handler\n * \n * - Straightforward handling of {{ }} constructions\n * - Full support for SA5 data-binding syntax \n */\n\nimport { WfuDataBinder, Sa5DataSourceDescriptor } from \"../../webflow-databind\";\n\nexport class DefaultTemplateHandler {\n\n    _dataBinder: WfuDataBinder;\n\n    constructor(dataBinder: WfuDataBinder) {\n      this._dataBinder = dataBinder;\n    }\n\n    processElement(elem: HTMLElement) {\n\n        let html = elem.innerHTML; \n\n        // Use the replace function with a regex to find and replace {{...}} constructions\n        html = html.replace(/{{(.*?)}}/g, (match: string, p1: string) => {\n            return this.processItem(p1, elem); \n        });\n\n        elem.innerHTML = html; \n    }\n\n    processItem(dsdSpecifier: string, elem: HTMLElement): string {\n\n      let dsd = new Sa5DataSourceDescriptor(dsdSpecifier);\n      return this._dataBinder.getData(dsd, elem); \n\n    }\n\n}\n\n"],
  "mappings": "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",
  "names": ["Sa5Attribute", "item"]
}
